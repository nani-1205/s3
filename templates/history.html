{% extends "base.html" %}

{% block title %}Migration History{% endblock %}

{% block content %}
<div class="container">
    <h1 style="color: white; margin-bottom: 20px;">Migration History</h1>
    {% if migrations %}
    <table class="history-table">
        <thead>
            <tr>
                <th>Start Time</th>
                <th>Status</th>
                <th>Source</th>
                <th>Destination</th>
                <th>Progress</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for migration in migrations %}
            <tr>
                <td>{{ migration.start_time.strftime('%Y-%m-%d %H:%M:%S') if migration.start_time else 'N/A' }}</td>
                <td>
                    <span class="status-badge {{ migration.status }}">{{ migration.status.replace('_', ' ')|title }}</span>
                </td>
                <td>
                    {{ migration.config.source_bucket }}/{{ migration.config.source_prefix }}
                </td>
                <td>
                    {{ migration.config.dest_bucket }}/{{ migration.config.dest_prefix }}
                </td>
                <td>{{ "%.2f"|format(migration.progress or 0) }}%</td>
                <td>
                    Files Scanned: {{ migration.files_scanned or 0 }}<br>
                    Files to Copy: {{ migration.total_files or 0 }}<br>
                    Completed: {{ migration.files_completed or 0 }}<br>
                    Failed: {{ migration.files_failed or 0 }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="auth-card" style="max-width: none;">
        <p>No migration history found for your account.</p>
    </div>
    {% endif %}
</div>
{% endblock %}